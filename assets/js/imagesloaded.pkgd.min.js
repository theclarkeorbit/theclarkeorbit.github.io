(function(){'use strict';function a(){}var b=a.prototype;var c=this;var d=c.EventEmitter;function e(a,b){var c=a.length;while(c--)if(a[c].listener===b)return c;return -1;}function f(a){return function b(){return this[a].apply(this,arguments);};}b.getListeners=function g(a){var b=this._getEvents();var c;var d;if(typeof a==='object'){c={};for(d in b)if(b.hasOwnProperty(d)&&a.test(d))c[d]=b[d];}else c=b[a]||(b[a]=[]);return c;};b.flattenListeners=function h(a){var b=[];var c;for(c=0;c<a.length;c+=1)b.push(a[c].listener);return b;};b.getListenersAsObject=function i(a){var b=this.getListeners(a);var c;if(b instanceof Array){c={};c[a]=b;}return c||b;};b.addListener=function j(a,b){var c=this.getListenersAsObject(a);var d=typeof b==='object';var f;for(f in c)if(c.hasOwnProperty(f)&&e(c[f],b)===-1)c[f].push(d?b:{listener:b,once:false});return this;};b.on=f('addListener');b.addOnceListener=function k(a,b){return this.addListener(a,{listener:b,once:true});};b.once=f('addOnceListener');b.defineEvent=function l(a){this.getListeners(a);return this;};b.defineEvents=function m(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this;};b.removeListener=function n(a,b){var c=this.getListenersAsObject(a);var d;var f;for(f in c)if(c.hasOwnProperty(f)){d=e(c[f],b);if(d!==-1)c[f].splice(d,1);}return this;};b.off=f('removeListener');b.addListeners=function o(a,b){return this.manipulateListeners(false,a,b);};b.removeListeners=function p(a,b){return this.manipulateListeners(true,a,b);};b.manipulateListeners=function q(a,b,c){var d;var e;var f=a?this.removeListener:this.addListener;var g=a?this.removeListeners:this.addListeners;if(typeof b==='object'&&!(b instanceof RegExp)){for(d in b)if(b.hasOwnProperty(d)&&(e=b[d]))if(typeof e==='function')f.call(this,d,e);else g.call(this,d,e);}else{d=c.length;while(d--)f.call(this,b,c[d]);}return this;};b.removeEvent=function r(a){var b=typeof a;var c=this._getEvents();var d;if(b==='string')delete c[a];else if(b==='object'){for(d in c)if(c.hasOwnProperty(d)&&a.test(d))delete c[d];}else delete this._events;return this;};b.removeAllListeners=f('removeEvent');b.emitEvent=function s(a,b){var c=this.getListenersAsObject(a);var d;var e;var f;var g;for(f in c)if(c.hasOwnProperty(f)){e=c[f].length;while(e--){d=c[f][e];if(d.once===true)this.removeListener(a,d.listener);g=d.listener.apply(this,b||[]);if(g===this._getOnceReturnValue())this.removeListener(a,d.listener);}}return this;};b.trigger=f('emitEvent');b.emit=function t(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b);};b.setOnceReturnValue=function u(a){this._onceReturnValue=a;return this;};b._getOnceReturnValue=function v(){if(this.hasOwnProperty('_onceReturnValue'))return this._onceReturnValue;else return true;};b._getEvents=function w(){return this._events||(this._events={});};a.noConflict=function x(){c.EventEmitter=d;return a;};if(typeof define==='function'&&define.amd)define(function(){return a;});else if(typeof module==='object'&&module.exports)module.exports=a;else this.EventEmitter=a;}.call(this));(function(a){'use strict';var b=document.documentElement;var c=function(){};if(b.addEventListener)c=function(a,b,c){a.addEventListener(b,c,false);};else if(b.attachEvent)c=function(b,c,d){b[c+d]=d.handleEvent?function(){var b=a.event;b.target=b.target||b.srcElement;d.handleEvent.call(d,b);}:function(){var c=a.event;c.target=c.target||c.srcElement;d.call(b,c);};b.attachEvent("on"+c,b[c+d]);};var d=function(){};if(b.removeEventListener)d=function(a,b,c){a.removeEventListener(b,c,false);};else if(b.detachEvent)d=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c];}catch(d){a[b+c]=undefined;}};var e={bind:c,unbind:d};if(typeof define==='function'&&define.amd)define(e);else a.eventie=e;})(this);(function(a){'use strict';var b=a.jQuery;var c=a.console;var d=typeof c!=='undefined';function e(a,b){for(var c in b)a[c]=b[c];return a;}var f=Object.prototype.toString;function g(a){return f.call(a)==='[object Array]';}function h(a){var b=[];if(g(a))b=a;else if(typeof a.length==='number')for(var c=0,d=a.length;c<d;c++)b.push(a[c]);else b.push(a);return b;}function i(a,f){function g(a,c,d){if(!(this instanceof g))return new g(a,c);if(typeof a==='string')a=document.querySelectorAll(a);this.elements=h(a);this.options=e({},this.options);if(typeof c==='function')d=c;else e(this.options,c);if(d)this.on('always',d);this.getImages();if(b)this.jqDeferred=new b.Deferred();var f=this;setTimeout(function(){f.check();});}g.prototype=new a();g.prototype.options={};g.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];if(c.nodeName==='IMG')this.addImage(c);var d=c.querySelectorAll('img');for(var e=0,f=d.length;e<f;e++){var g=d[e];this.addImage(g);}}};g.prototype.addImage=function(a){var b=new j(a);this.images.push(b);};g.prototype.check=function(){var a=this;var b=0;var e=this.images.length;this.hasAnyBroken=false;if(!e){this.complete();return;}function f(f,g){if(a.options.debug&&d)c.log('confirm',f,g);a.progress(f);b++;if(b===e)a.complete();return true;}for(var g=0;g<e;g++){var h=this.images[g];h.on('confirm',f);h.check();}};g.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit('progress',b,a);if(b.jqDeferred)b.jqDeferred.notify(b,a);});};g.prototype.complete=function(){var a=this.hasAnyBroken?'fail':'done';this.isComplete=true;var b=this;setTimeout(function(){b.emit(a,b);b.emit('always',b);if(b.jqDeferred){var c=b.hasAnyBroken?'reject':'resolve';b.jqDeferred[c](b);}});};if(b)b.fn.imagesLoaded=function(a,c){var d=new g(this,a,c);return d.jqDeferred.promise(b(this));};var i={};function j(a){this.img=a;}j.prototype=new a();j.prototype.check=function(){var a=i[this.img.src];if(a){this.useCached(a);return;}i[this.img.src]=this;if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,'naturalWidth');return;}var b=this.proxyImage=new Image();f.bind(b,'load',this);f.bind(b,'error',this);b.src=this.img.src;};j.prototype.useCached=function(a){if(a.isConfirmed)this.confirm(a.isLoaded,'cached was confirmed');else{var b=this;a.on('confirm',function(a){b.confirm(a.isLoaded,'cache emitted confirmed');return true;});}};j.prototype.confirm=function(a,b){this.isConfirmed=true;this.isLoaded=a;this.emit('confirm',this,b);};j.prototype.handleEvent=function(a){var b='on'+a.type;if(this[b])this[b](a);};j.prototype.onload=function(){this.confirm(true,'onload');this.unbindProxyEvents();};j.prototype.onerror=function(){this.confirm(false,'onerror');this.unbindProxyEvents();};j.prototype.unbindProxyEvents=function(){f.unbind(this.proxyImage,'load',this);f.unbind(this.proxyImage,'error',this);};return g;}if(typeof define==='function'&&define.amd)define(['eventEmitter/EventEmitter','eventie/eventie'],i);else a.imagesLoaded=i(a.EventEmitter,a.eventie);})(window);