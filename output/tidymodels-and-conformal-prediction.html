<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>"Tidymodels and conformal prediction" - p. bhogale</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href=".//images/gravtar.jpg" rel="icon">

<link rel="canonical" href="./tidymodels-and-conformal-prediction.html">

        <meta name="author" content="pras" />
        <meta name="description" content="Reading material: The tidy modeling book The tidymodels blog on conformal regression The notes of Angelopoulos The notes of Tibshirani The book of Christoph Molnar The book of Valeriy Manokhin The package of Sussman et al. Getting some data We will look at Indian trade data hosted on Kaggle for …" />

        <meta property="og:site_name" content="p. bhogale" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="&#34;Tidymodels and conformal prediction&#34;"/>
        <meta property="og:url" content="./tidymodels-and-conformal-prediction.html"/>
        <meta property="og:description" content="Reading material: The tidy modeling book The tidymodels blog on conformal regression The notes of Angelopoulos The notes of Tibshirani The book of Christoph Molnar The book of Valeriy Manokhin The package of Sussman et al. Getting some data We will look at Indian trade data hosted on Kaggle for …"/>
        <meta property="article:published_time" content="2024-07-22" />
            <meta property="article:section" content="data_sci_tech" />
            <meta property="article:author" content="pras" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>

        <link href="./feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="p. bhogale ATOM Feed"/>

        <link href="./feeds/data_sci_tech.atom.xml" type="application/atom+xml" rel="alternate"
              title="p. bhogale data_sci_tech ATOM Feed"/>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115756026-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', UA-115756026-1);
    </script>
    <!-- End Google Analytics Code -->
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','');</script>
    <!-- End Google Tag Manager -->

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
<img class="img-responsive pull-left gap-right" src=".//images/gravtar.jpg" width=""/> p. bhogale            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="./category/blog.html">Blog</a>
                        </li>
                        <li class="active">
                            <a href="./category/data_sci_tech.html">Data_sci_tech</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<style>
	#banner{
	    background-image:url(".//images/banner.jpg");
	}
</style>

<div id="banner">
	<div class="container">
		<div class="copy">
			<h1>p. bhogale</h1>
				<p class="intro">Data Sci, Quant Fin, Quant Bio.</p>
		</div>
	</div>
</div><!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./tidymodels-and-conformal-prediction.html"
                       rel="bookmark"
                       title="Permalink to "Tidymodels and conformal prediction"">
                        "Tidymodels and conformal prediction"
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2024-07-22T00:00:00+02:00"> Mon 22 July 2024</time>
    </span>





    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h3>Reading material:</h3>
<ol>
<li><a href="https://www.tmwr.org/">The tidy modeling book</a></li>
<li><a href="https://www.tidymodels.org/learn/models/conformal-regression/">The tidymodels blog on conformal regression</a></li>
<li><a href="https://arxiv.org/abs/2107.07511">The notes of Angelopoulos</a></li>
<li><a href="https://www.stat.berkeley.edu/~ryantibs/statlearn-s23/lectures/conformal.pdf">The notes of Tibshirani</a></li>
<li><a href="https://christophmolnar.com/books/conformal-prediction/">The book of Christoph Molnar</a></li>
<li><a href="https://maven.com/valeriy-manokhin/applied-conformal-prediction">The book of Valeriy Manokhin</a></li>
<li><a href="https://github.com/herbps10/AdaptiveConformal">The package</a> of <a href="https://arxiv.org/abs/2312.00448">Sussman et al.</a></li>
</ol>
<h3>Getting some data</h3>
<p>We will look at <a href="https://www.kaggle.com/datasets/lakshyaag/india-trade-data">Indian trade data</a> hosted on Kaggle for the purposes of illustrating the tidy modeling techniques, without focusing too much on exploring the data.</p>
<div class="highlight"><pre><span></span><code>&lt;!--<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>kaggle<span class="w"> </span>--&gt;
&lt;!--<span class="w"> </span>mkdir<span class="w"> </span>~/.datasets/india_trade_data<span class="w"> </span>--&gt;
&lt;!--<span class="w"> </span>kaggle<span class="w"> </span>datasets<span class="w"> </span>download<span class="w"> </span>-d<span class="w"> </span>lakshyaag/india-trade-data<span class="w"> </span>--&gt;
&lt;!--<span class="w"> </span>mv<span class="w"> </span>india-trade-data.zip<span class="w"> </span>~/.datasets/india_trade_data/<span class="w"> </span>--&gt;
&lt;!--<span class="w"> </span>unzip<span class="w"> </span>-d<span class="w"> </span>~/.datasets/india_trade_data<span class="w"> </span>~/.datasets/india_trade_data/india-trade-data.zip<span class="w">  </span>--&gt;
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="cp">## bash: -c: line 1: syntax error near unexpected token `newline&#39;</span>
<span class="cp">## bash: -c: line 1: `&lt;!-- pip install kaggle --&gt;&#39;</span>
</code></pre></div>

<p>Just for simplicity, we will stick to the HS2 files (2010-2021), and ignore the other two (HS trade data) files that run from 2010-2018. We will combine the two files into a single data frame with an added column indicating direction of trade. We also interpret NAs in the <code>value</code> column to mean that there was no trade, and replace those with 0.</p>
<p>To make this something of a modelling challenge, we have enhanced the data with some information about the countries India is trading with, like the GDP. We downloaded GDP data from the World Bank with the <code>WDI</code> package. Then, we did a left join onto the Indian trade data on country and year, by first converting the countries in the Indian trade to their ISO3 codes via the <code>countries</code> package.</p>
<p>The data frame we now have will serve as the basis for us to explore tidy modeling and conformal prediction in R.</p>
<div class="highlight"><pre><span></span><code><span class="n">df</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">sample_n</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">## # A tibble: 10 × 6</span>
<span class="c1">##    country                year trade_direction   value     gdp population</span>
<span class="c1">##    &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="c1">##  1 Mongolia               2020 export            18.9  1.33e10    3294335</span>
<span class="c1">##  2 Solomon Islands        2018 export             2.56 1.62e 9     659249</span>
<span class="c1">##  3 Belize                 2021 export            15.2  2.42e 9     400031</span>
<span class="c1">##  4 Macao SAR, China       2010 export             1.42 2.82e10     557297</span>
<span class="c1">##  5 Brazil                 2013 export          5552.   2.47e12  201721767</span>
<span class="c1">##  6 Czechia                2013 export           387.   2.12e11   10514272</span>
<span class="c1">##  7 Sao Tome and Principe  2011 export             0.75 2.26e 8     186044</span>
<span class="c1">##  8 Guam                   2012 import             0    5.27e 9     166392</span>
<span class="c1">##  9 Spain                  2017 import          1663.   1.31e12   46593236</span>
<span class="c1">## 10 Madagascar             2020 export           324.   1.31e10   28225177</span>
</code></pre></div>

<h3>Tidy modeling in R</h3>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/pbhogale"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="https://github.com/pbhogale"><i class="fa fa-github-square fa-lg"></i> github</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="./tidymodels-and-conformal-prediction.html">"Tidymodels and conformal prediction"</a></li>
    <li class="list-group-item"><a href="./r-torch-and-the-little-book-of-deep-learning.html">"R, Torch, and the little book of deep learning"</a></li>
    <li class="list-group-item"><a href="./becoming-a-data-scientist-an-opinionated-take-in-2020.html">"Becoming a Data Scientist : an opinionated take in 2020"</a></li>
    <li class="list-group-item"><a href="./linear-and-mixed-integer-programming.html">"Linear and mixed integer programming"</a></li>
    <li class="list-group-item"><a href="./the-invisible-hand.html">"The Invisible Hand"</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2024 pras
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>


    <script src="./theme/js/bodypadding.js"></script>


</body>
</html>