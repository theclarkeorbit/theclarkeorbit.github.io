<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>"Linear and mixed integer programming" - p. bhogale</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href=".//images/gravtar.jpg" rel="icon">

<link rel="canonical" href="./linear-and-mixed-integer-programming.html">

        <meta name="author" content="pras" />
        <meta name="description" content="post inspired by the OptiPy meetup. link to meetup Linear programming Wiki article on linear programming. Combining the concept of an objective function with constraints. Dantzig came up with the simplex algorithm. The most common solver in python is PuLP. Optimisation problems where the constraints and cost function are linear …" />

        <meta property="og:site_name" content="p. bhogale" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="&#34;Linear and mixed integer programming&#34;"/>
        <meta property="og:url" content="./linear-and-mixed-integer-programming.html"/>
        <meta property="og:description" content="post inspired by the OptiPy meetup. link to meetup Linear programming Wiki article on linear programming. Combining the concept of an objective function with constraints. Dantzig came up with the simplex algorithm. The most common solver in python is PuLP. Optimisation problems where the constraints and cost function are linear …"/>
        <meta property="article:published_time" content="2018-09-08" />
            <meta property="article:section" content="data_sci_tech" />
            <meta property="article:author" content="pras" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>

        <link href="./feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="p. bhogale ATOM Feed"/>



        <link href="./feeds/data_sci_tech.atom.xml" type="application/atom+xml" rel="alternate"
              title="p. bhogale data_sci_tech ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
<img class="img-responsive pull-left gap-right" src=".//images/gravtar.jpg" width=""/> p. bhogale            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="./category/blog.html">Blog</a>
                        </li>
                        <li class="active">
                            <a href="./category/data_sci_tech.html">Data_sci_tech</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<style>
	#banner{
	    background-image:url(".//images/banner.jpg");
	}
</style>

<div id="banner">
	<div class="container">
		<div class="copy">
			<h1>p. bhogale</h1>
				<p class="intro">Data Sci, Quant Fin, Quant Bio.</p>
		</div>
	</div>
</div><!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./linear-and-mixed-integer-programming.html"
                       rel="bookmark"
                       title="Permalink to "Linear and mixed integer programming"">
                        "Linear and mixed integer programming"
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-09-08T00:00:00+02:00"> Sat 08 September 2018</time>
    </span>





    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>post inspired by the OptiPy meetup. <a href="https://www.meetup.com/OptiPy-Python-Quants-of-BeNeDeLux/events/253090625/">link to meetup</a></p>
<h2>Linear programming</h2>
<p><a href="https://en.wikipedia.org/wiki/Linear_programming">Wiki article on linear programming</a>. Combining the concept of an objective function with constraints. Dantzig came up with the <a href="https://en.wikipedia.org/wiki/Simplex_algorithm">simplex algorithm</a>. The most common solver in python is <a href="https://pythonhosted.org/PuLP/">PuLP</a>.</p>
<p>Optimisation problems where the constraints and cost function are linear, and the decision variables are continuous, are the simple, canonical domain of linear programming. However, such problems can be solved in polynomial time, which means that to tackle a hard (NP hard) problem with this framework, the problem definition needs to be exponentially large (<a href="https://www.cwi.nl/system/files/scimeeting13.pdf">see this (pdf)</a>).</p>
<p>However, if we allow for (some) decision variables to be integers instead of continuous, a much richer range of problems can be expressed and solved in a similar framework. This is called mixed integer programming.</p>
<p>First, a toy linear programming problem in PuLP.</p>
<h3>Simple linear programming</h3>
<p>Eat the optimal amount of schnitzel and pommes to survive, given nutrition value and costs in terms of various ingredients. Assume that schnitzel and pommes come in continuous quantities :D</p>
<p>Decision vars :
<em> how much schnitzel : x1
</em> how much pommes : x2</p>
<p><code>cost = 8*x1 + 3*x2</code></p>
<p>constraints :</p>
<div class="highlight"><pre><span></span> 23*x1 + 33*x2 &gt;= 150
 18*x1 + 4*x2 &gt;= 50
 15*x1 + 13*x2 &lt;= 75
</pre></div>


<p>code :</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pulp</span>

<span class="n">diet_program</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpProblem</span><span class="p">(</span><span class="s2">&quot;Diet Program&quot;</span><span class="p">,</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpMinimize</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpVariable</span><span class="p">(</span><span class="s2">&quot;schnitzel&quot;</span><span class="p">,</span> <span class="n">lowBound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cat</span><span class="o">=</span><span class="s2">&quot;Continuous&quot;</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpVariable</span><span class="p">(</span><span class="s2">&quot;pommes&quot;</span><span class="p">,</span> <span class="n">lowBound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cat</span><span class="o">=</span><span class="s2">&quot;Continuous&quot;</span><span class="p">)</span>

<span class="n">diet_program</span> <span class="o">+=</span> <span class="mi">8</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span>

<span class="n">diet_program</span> <span class="o">+=</span> <span class="mi">23</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">33</span><span class="o">*</span><span class="n">x2</span> <span class="o">&gt;=</span> <span class="mi">150</span>
<span class="n">diet_program</span> <span class="o">+=</span> <span class="mi">18</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x2</span> <span class="o">&gt;=</span> <span class="mi">50</span>
<span class="n">diet_program</span> <span class="o">+=</span> <span class="mi">15</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">x2</span> <span class="o">&lt;=</span> <span class="mi">75</span>

<span class="n">diet_program</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="n">diet_program</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">pulp</span><span class="o">.</span><span class="n">LpStatus</span><span class="p">[</span><span class="n">diet_program</span><span class="o">.</span><span class="n">status</span><span class="p">]</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">diet_program</span><span class="o">.</span><span class="n">variables</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">variable</span><span class="o">.</span><span class="n">varValue</span><span class="p">))</span>
</pre></div>


<p>giving the result</p>
<div class="highlight"><pre><span></span>pommes = 3.0876494
schnitzel = 2.0916335
</pre></div>


<p>Often, real problems have a large number of decision variables and constraints, but LP problems remain tractable (by and large) even in high dimensions.</p>
<h2>Mixed integer programming</h2>
<p>Mixed integer models, however, are a different story. Large models are very hard to solve with open source solvers and advanced commercial solvers are needed to solve real world mixed integer models in a reasonable amount of time.</p>
<h3>Material</h3>
<ol>
<li>the Sagemath documentation page has a rather <a href="http://doc.sagemath.org/html/en/thematic_tutorials/linear_programming.html">good chapter</a>) on linear and mixed integer programming. On the face of it, the syntax seems more elegant and extensible than <a href="https://pythonhosted.org/PuLP/">PuLP</a></li>
<li>For R, most optimisation problems need matrix definitions and this makes constructing large models in R basically impossible. The <a href="https://channel9.msdn.com/Events/useR-international-R-User-conferences/useR-International-R-User-2017-Conference/ompr-an-alternative-way-to-model-mixed-integer-linear-programs">ompr package</a> seems to solve this issue, and enables construction of models in a step by step fashion, like PuLP and sagemath.</li>
</ol>
<p>Below, we will work through a couple of relatively simple problems in sagemath, R and PuLP.</p>
<h3>Tutorial - knapsack problem.</h3>
<h4>Sagemath version</h4>
<p>see <a href="http://doc.sagemath.org/html/en/thematic_tutorials/linear_programming.html">this page</a> for an intro and sage code.</p>
<p>We have some objects L each with some weights and some usefulness. We can carry a maximum weight of C, while optimising the total usefulness of the objects we pack.</p>
<p>Below, we assign random weights and usefulness to our objects-</p>
<div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pan&quot;</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">,</span> <span class="s2">&quot;knife&quot;</span><span class="p">,</span> <span class="s2">&quot;gourd&quot;</span><span class="p">,</span> <span class="s2">&quot;flashlight&quot;</span><span class="p">]</span>
<span class="n">L</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;random_stuff_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">weight</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">usefulness</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">685474</span><span class="p">)</span>
<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
    <span class="n">weight</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
    <span class="n">usefulness</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
</pre></div>


<p>We now define the mixed integer model.
The objective to be maximised is usefulness of taken objects, the constraint is the maximum weight C and the only decision variables are an array of binary variables corresponding to each objects, determining if they are taken or not.</p>
<div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MixedIntegerLinearProgram</span><span class="p">()</span>
<span class="n">taken</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">new_variable</span><span class="p">(</span><span class="n">binary</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">*</span> <span class="n">taken</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">L</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">C</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">usefulness</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">*</span> <span class="n">taken</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">L</span><span class="p">))</span>
</pre></div>


<p>Having set up the model, we solve it using the in-built optimizer.</p>
<div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span> <span class="c1"># abs tol 1e-6</span>
<span class="n">taken</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">taken</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;the total weight of taken objects is&#39;</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">weight</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">*</span> <span class="n">taken</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">L</span><span class="p">)</span>
</pre></div>


<p>which gives the expected result.</p>
<div class="highlight"><pre><span></span>the total weight of taken objects is
0.6964959796619171
</pre></div>


<h4>R version</h4>
<p>Most optimisers in R (including the popular <a href="https://cran.r-project.org/web/packages/ROI/">ROI</a> package that provides a unified interface to multiple solvers) need problem definitions in matrix form. However, matrix definitions are not easy to read and interpret, and are the end result of a process of problem definition. Step by step definitions of the optimisation problem (like the one above) provide a much better framework in which to understand and define optimisation problems.</p>
<p>The <a href="https://dirkschumacher.github.io/ompr/">ompr</a> package provides such an interface for problem definition and solution in R, using the pipe operator from the <a href="https://www.tidyverse.org/">Tidyverse</a>.</p>
<p>Setting up the basics</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ROI<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ROI.plugin.glpk<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ompr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ompr.roi<span class="p">)</span>

C <span class="o">&lt;-</span> <span class="m">1</span> <span class="c1"># max weight</span>
L <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span><span class="s">&quot;torch&quot;</span><span class="p">,</span> <span class="s">&quot;food&quot;</span><span class="p">,</span> <span class="s">&quot;tent&quot;</span><span class="p">,</span> <span class="s">&quot;knife&quot;</span><span class="p">,</span> <span class="s">&quot;books&quot;</span><span class="p">)</span> <span class="c1"># objects</span>
<span class="kr">for</span><span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">)</span> <span class="p">{</span>
    L <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>L<span class="p">,</span> <span class="kp">paste</span><span class="p">(</span><span class="s">&#39;random_stuff&#39;</span><span class="p">,</span>j<span class="p">,</span>sep <span class="o">=</span> <span class="s">&#39;_&#39;</span><span class="p">))</span>
<span class="p">}</span>
weight_list <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">()</span>
usefulness_list <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">()</span>
<span class="kp">set.seed</span><span class="p">(</span><span class="m">685474</span><span class="p">)</span>
<span class="kr">for</span><span class="p">(</span>j <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="kp">length</span><span class="p">(</span>L<span class="p">))</span> <span class="p">{</span>
    weight_list <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>weight_list<span class="p">,</span> <span class="kp">unlist</span><span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)))</span>
    usefulness_list <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>usefulness_list<span class="p">,</span> <span class="kp">unlist</span><span class="p">(</span>runif<span class="p">(</span><span class="m">1</span><span class="p">)))</span>
<span class="p">}</span>
usefulness <span class="o">&lt;-</span> <span class="kp">as.numeric</span><span class="p">(</span>usefulness_list<span class="p">)</span>
weight <span class="o">&lt;-</span> <span class="kp">as.numeric</span><span class="p">(</span>weight_list<span class="p">)</span>
</pre></div>


<p>Defining the model</p>
<div class="highlight"><pre><span></span>n <span class="o">=</span> <span class="kp">length</span><span class="p">(</span>L<span class="p">)</span>
model_mip <span class="o">&lt;-</span> MIPModel<span class="p">()</span> <span class="o">%&gt;%</span>
    add_variable<span class="p">(</span>x<span class="p">[</span>i<span class="p">],</span> i<span class="o">=</span><span class="m">1</span><span class="o">:</span>n<span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;binary&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    set_objective<span class="p">(</span>sum_expr<span class="p">(</span>usefulness<span class="p">[</span>i<span class="p">]</span><span class="o">*</span>x<span class="p">[</span>i<span class="p">],</span> i<span class="o">=</span><span class="m">1</span><span class="o">:</span>n<span class="p">),</span> <span class="s">&quot;max&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    add_constraint<span class="p">(</span>sum_expr<span class="p">(</span>weight<span class="p">[</span>i<span class="p">]</span><span class="o">*</span>x<span class="p">[</span>i<span class="p">],</span> i<span class="o">=</span><span class="m">1</span><span class="o">:</span>n<span class="p">)</span> <span class="o">&lt;=</span> C<span class="p">)</span>
</pre></div>


<p>Solving the model with the <code>glpk</code>  solver.</p>
<div class="highlight"><pre><span></span>solution <span class="o">&lt;-</span> model_mip <span class="o">%&gt;%</span>
    solve_model<span class="p">(</span>with_ROI<span class="p">(</span>solver <span class="o">=</span> <span class="s">&quot;glpk&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span>
    get_solution<span class="p">(</span>x<span class="p">[</span>i<span class="p">])</span> <span class="o">%&gt;%</span>
    arrange<span class="p">(</span>i<span class="p">)</span>
</pre></div>


<p>And then checking what the weight of our knapsack is !</p>
<div class="highlight"><pre><span></span>solution_data <span class="o">&lt;-</span> <span class="kt">data_frame</span><span class="p">(</span>objects <span class="o">=</span> <span class="kp">unlist</span><span class="p">(</span>L<span class="p">),</span> usefulness <span class="o">=</span> usefulness<span class="p">,</span> weights <span class="o">=</span> weight<span class="p">,</span> taken <span class="o">=</span> solution<span class="o">$</span>value<span class="p">)</span>
objects_taken <span class="o">&lt;-</span> solution_data <span class="o">%&gt;%</span>
    filter<span class="p">(</span>taken<span class="o">&gt;</span><span class="m">0.5</span><span class="p">)</span>
<span class="kp">print</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>objects_taken<span class="o">$</span>weights<span class="p">))</span>
</pre></div>


<p>and it is</p>
<div class="highlight"><pre><span></span>[1] 0.949882
</pre></div>


<h4>PuLP version</h4>
<p>The pulp problem is setup in a very similar fashion to the sage problem.  Below is the entire code for the problem solution in PuLP.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pulp</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">C</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># the max weight</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span> <span class="s2">&quot;food&quot;</span><span class="p">,</span> <span class="s2">&quot;tent&quot;</span><span class="p">,</span> <span class="s2">&quot;knife&quot;</span><span class="p">,</span> <span class="s2">&quot;books&quot;</span><span class="p">]</span>
<span class="n">L</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;random_stuff&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">weight</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">usefulness</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">685474</span><span class="p">)</span>
<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
    <span class="n">weight</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">usefulness</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#the decision variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpVariable</span><span class="o">.</span><span class="n">dicts</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">lowBound</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upBound</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cat</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpInteger</span><span class="p">)</span>

<span class="c1"># declaring the PuLP model</span>
<span class="n">knapsack_model</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpProblem</span><span class="p">(</span><span class="s2">&quot;knapsack&quot;</span><span class="p">,</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpMaximize</span><span class="p">)</span>
<span class="c1"># cost function :</span>
<span class="n">knapsack_model</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">usefulness</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]),</span> <span class="s2">&quot;usefulness&quot;</span>
<span class="c1"># constraints</span>
<span class="n">knapsack_model</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">weight</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">thing</span><span class="p">]</span> <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">L</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">C</span>

<span class="c1"># solving the model</span>
<span class="n">knapsack_model</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="n">pulp</span><span class="o">.</span><span class="n">LpStatus</span><span class="p">[</span><span class="n">knapsack_model</span><span class="o">.</span><span class="n">status</span><span class="p">]</span>

<span class="c1"># displaying the solution in a useful form</span>
<span class="n">total_weight</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">things</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">knapsack_model</span><span class="o">.</span><span class="n">variables</span><span class="p">():</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">things</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">varValue</span>
    <span class="n">total_weight</span> <span class="o">+=</span> <span class="n">weight</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">*</span><span class="n">things</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="c1"># print(&quot;{} = {}&quot;.format(var, variable.varValue))</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;the total weight taken is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">total_weight</span><span class="p">))</span>
<span class="n">solution_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">weight</span><span class="p">,</span> <span class="n">usefulness</span><span class="p">,</span> <span class="n">things</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">solution_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;usefulness&#39;</span><span class="p">,</span> <span class="s1">&#39;taken&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">solution_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>


<p>with the output</p>
<div class="highlight"><pre><span></span>the total weight taken is 0.911966521327
                 weight  usefulness  taken
books          0.977869    0.290585    0.0
food           0.112391    0.445158    1.0
knife          0.735062    0.919826    0.0
random_stuff0  0.881662    0.800397    0.0
random_stuff1  0.888736    0.636453    0.0
</pre></div>


<p>With these basics out of the way, we can tackle a non-trivial model inspired by real data in the next post.</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/pbhogale"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="https://twitter.com/thegymnosophist"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
    <li class="list-group-item"><a href="https://github.com/pbhogale"><i class="fa fa-github-square fa-lg"></i> github</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="./linear-and-mixed-integer-programming.html">"Linear and mixed integer programming"</a></li>
    <li class="list-group-item"><a href="./the-invisible-hand.html">"The Invisible Hand"</a></li>
    <li class="list-group-item"><a href="./greta-playground.html">"greta playground"</a></li>
    <li class="list-group-item"><a href="./notes-from-the-original-ml-course-by-andrew-ng.html">"Notes from the original ML course by Andrew Ng"</a></li>
    <li class="list-group-item"><a href="./i-once-was-lost-but-now-am-dad.html">I once was lost... but now am Dad ?</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 pras
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>


    <script src="./theme/js/bodypadding.js"></script>
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-115756026-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


</body>
</html>