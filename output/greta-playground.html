<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="pras" />
        <meta name="copyright" content="pras" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", blogs, " />

<meta property="og:title" content="“greta playground” "/>
<meta property="og:url" content="./greta-playground.html" />
<meta property="og:description" content="This notebook contains one simple worked out example with the new - still in its infancy - PPL in R with a Tensorflow backend : https://greta-dev.github.io/greta/index.html For a more mature PPL in Python also with a tensorflow backend, see Edward. Basic linear regression. We will generate artificial data with known parameters, so that we can check if Greta gets it right later. Generating fake data to fit a model to length_of_data &lt;- 100 sd_eps &lt;- pi^exp(1) intercept &lt;- -5.0 slope &lt;- pi x &lt;- seq(-10*pi, 10*pi, length.out = length_of_data) y &lt;- intercept + slope*x + rnorm(n = length_of_data …" />
<meta property="og:site_name" content="p. bhogale" />
<meta property="og:article:author" content="pras" />
<meta property="og:article:published_time" content="2018-03-14T12:30:42.364918+01:00" />
<meta name="twitter:title" content="“greta playground” ">
<meta name="twitter:description" content="This notebook contains one simple worked out example with the new - still in its infancy - PPL in R with a Tensorflow backend : https://greta-dev.github.io/greta/index.html For a more mature PPL in Python also with a tensorflow backend, see Edward. Basic linear regression. We will generate artificial data with known parameters, so that we can check if Greta gets it right later. Generating fake data to fit a model to length_of_data &lt;- 100 sd_eps &lt;- pi^exp(1) intercept &lt;- -5.0 slope &lt;- pi x &lt;- seq(-10*pi, 10*pi, length.out = length_of_data) y &lt;- intercept + slope*x + rnorm(n = length_of_data …">

        <title>“greta playground”  · p. bhogale
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="./theme/css/pygments.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/tipuesearch/tipuesearch.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container-fluid">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="./"><span class=site-name>p. bhogale</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <li ><a href=".">Home</a></li>
                            <li ><a href="./categories.html">Categories</a></li>
                            <li ><a href="./tags.html">Tags</a></li>
                            <li ><a href="./archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="./search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="./greta-playground.html"> <span class="dquo">&#8220;</span>greta&nbsp;playground&#8221;  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            
            <p>This notebook contains one simple worked out example with the new - still in its infancy - <span class="caps">PPL</span> in R with a Tensorflow backend :&nbsp;https://greta-dev.github.io/greta/index.html</p>
<p>For a more mature <span class="caps">PPL</span> in Python also with a tensorflow backend, see <a href="http://edwardlib.org/">Edward</a>.</p>
<h2>Basic linear&nbsp;regression.</h2>
<p>We will generate artificial data with known parameters, so that we can check if Greta gets it right&nbsp;later. </p>
<h3>Generating fake data to fit a model&nbsp;to</h3>
<div class="highlight"><pre><span></span>length_of_data <span class="o">&lt;-</span> <span class="m">100</span>
sd_eps <span class="o">&lt;-</span> <span class="kc">pi</span><span class="o">^</span><span class="kp">exp</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
intercept <span class="o">&lt;-</span> <span class="m">-5.0</span>
slope <span class="o">&lt;-</span> <span class="kc">pi</span>
x <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">-10</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span> <span class="m">10</span><span class="o">*</span><span class="kc">pi</span><span class="p">,</span> length.out <span class="o">=</span> length_of_data<span class="p">)</span>
y <span class="o">&lt;-</span> intercept <span class="o">+</span> slope<span class="o">*</span>x <span class="o">+</span> rnorm<span class="p">(</span>n <span class="o">=</span> length_of_data<span class="p">,</span> mean <span class="o">=</span> <span class="m">0</span><span class="p">,</span> sd <span class="o">=</span> sd_eps<span class="p">)</span>
data <span class="o">&lt;-</span> <span class="kt">data_frame</span><span class="p">(</span>y <span class="o">=</span> y<span class="p">,</span> x <span class="o">=</span> x<span class="p">)</span>
ggplot<span class="p">(</span>data<span class="p">,</span> aes<span class="p">(</span>x <span class="o">=</span> x<span class="p">,</span> y <span class="o">=</span> y<span class="p">))</span> <span class="o">+</span>
  geom_point<span class="p">()</span> <span class="o">+</span>
  geom_smooth<span class="p">()</span> <span class="o">+</span>
  ggtitle<span class="p">(</span><span class="s">&quot;Fake experimental data&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## `geom_smooth()` using method = &#39;loess&#39;
</pre></div>


<p><img alt="center" src="$(pwd">/figures/greta_playground/unnamed-chunk-2-1.png)</p>
<p>Given this data, we want to write Greta code to infer the model parameters. Since we really don&#8217;t know anything about the prior distributions of our parameters, we look at the experimental data and take rough, uniform&nbsp;priors. </p>
<h3>Defining clueless priors for model&nbsp;parameters</h3>
<div class="highlight"><pre><span></span>intercept_p <span class="o">&lt;-</span> uniform<span class="p">(</span><span class="m">-10</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
sd_eps_p <span class="o">&lt;-</span> uniform<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">50</span><span class="p">)</span>
slope_p <span class="o">&lt;-</span> uniform<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
</pre></div>


<p>Now, we define and plot the&nbsp;model.</p>
<h3>Defining the&nbsp;model</h3>
<div class="highlight"><pre><span></span>mean_y <span class="o">&lt;-</span> intercept_p<span class="o">+</span>slope_p<span class="o">*</span>x
distribution<span class="p">(</span>y<span class="p">)</span> <span class="o">&lt;-</span> normal<span class="p">(</span>mean_y<span class="p">,</span> sd_eps_p<span class="p">)</span>

our_model <span class="o">&lt;-</span> model<span class="p">(</span>intercept_p<span class="p">,</span> slope_p<span class="p">,</span> sd_eps_p<span class="p">)</span>
plot<span class="p">(</span>our_model<span class="p">)</span>
</pre></div>


<h3>Fitting model to&nbsp;data</h3>
<p>Now, we sample from our&nbsp;model</p>
<div class="highlight"><pre><span></span>num_samples <span class="o">&lt;-</span> <span class="m">1000</span>
param_draws <span class="o">&lt;-</span> mcmc<span class="p">(</span>our_model<span class="p">,</span> n_samples <span class="o">=</span> num_samples<span class="p">,</span> warmup <span class="o">=</span> num_samples <span class="o">/</span> <span class="m">10</span><span class="p">)</span>
</pre></div>


<p>and plot the samples, and the parameter&nbsp;fits.</p>
<div class="highlight"><pre><span></span>mcmc_dens<span class="p">(</span>param_draws<span class="p">)</span>
</pre></div>


<p><img alt="center" src="$(pwd">/figures/greta_playground/unnamed-chunk-6-1.png)</p>
<div class="highlight"><pre><span></span>mcmc_intervals<span class="p">(</span>param_draws<span class="p">)</span>
</pre></div>


<p><img alt="center" src="$(pwd">/figures/greta_playground/unnamed-chunk-6-2.png)</p>
<p>By inspection, it looks like the <a href="https://arxiv.org/abs/1701.02434"><span class="caps">HMC</span></a> has reached some reasonable values for our model&nbsp;parameters. </p>
<p>Explicitly, the mean estimates can be computed from the <code>param_draws</code> data structure, or via the <code>greta::opt</code> function.   </p>
<div class="highlight"><pre><span></span>param_draws_df <span class="o">&lt;-</span> as_data_frame<span class="p">(</span>param_draws<span class="p">[[</span><span class="m">1</span><span class="p">]])</span>
param_estimates <span class="o">&lt;-</span> param_draws_df <span class="o">%&gt;%</span> 
  summarise_all<span class="p">(</span><span class="kp">mean</span><span class="p">)</span>
param_estimates <span class="o">%&gt;%</span> <span class="kp">print</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 1 x 3
##   intercept_p slope_p sd_eps_p
##         &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1       -2.32    3.23     22.2
</pre></div>


<div class="highlight"><pre><span></span>opt_params <span class="o">&lt;-</span> opt<span class="p">(</span>our_model<span class="p">)</span>
opt_params<span class="o">$</span>par <span class="o">%&gt;%</span> <span class="kp">print</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>## intercept_p     slope_p    sd_eps_p 
##    2.503366    3.277133   20.958645
</pre></div>


<h3>Plotting against&nbsp;data</h3>
<p>the <code>calculate()</code> function is available on the latest release of <code>greta</code> on&nbsp;github.</p>
            
            
            <hr/>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2018-03-14T12:30:42.364918+01:00">Mar 14, 2018</time>
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#blogs-ref">blogs</a>
<h4>Contact</h4>
    <a href="https://www.linkedin.com/in/pbhogale" title="My linkedin Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-linkedin sidebar-social-links"></i></a>
    <a href="https://twitter.com/thegymnosophist" title="My twitter Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-twitter sidebar-social-links"></i></a>
    <a href="https://github.com/pbhogale" title="My github Profile" class="sidebar-social-links" target="_blank">
    <i class="fa fa-github sidebar-social-links"></i></a>
        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
        <div id="push"></div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-subtitle"><span class="site-name">p. bhogale</span> - Data Sci, Quant Fin, Quant Bio.</li>
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    
    </body>
    <!-- Theme: Elegant built for Pelican
    License : http://oncrashreboot.com/pelican-elegant -->
</html>